<!DOCTYPE html>
<html class="writer-html5" lang="python">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>torch_pgn.graphs package &mdash; torch_pgn 0.1.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
    <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            torch_pgn
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">torch_pgn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">torch_pgn.graphs package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/torch_pgn.graphs.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="torch-pgn-graphs-package">
<h1>torch_pgn.graphs package<a class="headerlink" href="#torch-pgn-graphs-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-torch_pgn.graphs.graph_utils">
<span id="torch-pgn-graphs-graph-utils-module"></span><h2>torch_pgn.graphs.graph_utils module<a class="headerlink" href="#module-torch_pgn.graphs.graph_utils" title="Permalink to this heading"></a></h2>
</section>
<section id="module-torch_pgn.graphs.proximal_residues">
<span id="torch-pgn-graphs-proximal-residues-module"></span><h2>torch_pgn.graphs.proximal_residues module<a class="headerlink" href="#module-torch_pgn.graphs.proximal_residues" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="torch_pgn.graphs.proximal_residues.extract_cross_edges">
<span class="sig-prename descclassname"><span class="pre">torch_pgn.graphs.proximal_residues.</span></span><span class="sig-name descname"><span class="pre">extract_cross_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protein_atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ligand_atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_pgn.graphs.proximal_residues.extract_cross_edges" title="Permalink to this definition"></a></dt>
<dd><p>Creates a set of cross edges formatted in pytorch geometric compatible format.
:param protein_atoms: Numpy atom_dict of the form output by get_interacting atoms (see close_contract documentation
for ODDT: <a class="reference external" href="https://oddt.readthedocs.io/en/0.1.1/rst/oddt.html">https://oddt.readthedocs.io/en/0.1.1/rst/oddt.html</a>) for the interaction protein atoms
:param ligand_atoms: Numpy atom_dict of the form output by get_interacting atoms (see close_contract documentation
for ODDT: <a class="reference external" href="https://oddt.readthedocs.io/en/0.1.1/rst/oddt.html">https://oddt.readthedocs.io/en/0.1.1/rst/oddt.html</a>) for the interaction ligand atoms
:return: A numpy array of edge formatted for pytorch. Format is [[s1, s2, s3...], [d1, d2, d3, ...]].
All source vertices will be in the ligand and all dest vectices will be in protein. Final processing will be done
in order to make graph undirected if desired. And have correct numbering</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torch_pgn.graphs.proximal_residues.get_interacting_atoms">
<span class="sig-prename descclassname"><span class="pre">torch_pgn.graphs.proximal_residues.</span></span><span class="sig-name descname"><span class="pre">get_interacting_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ligand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protein</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_hoh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_pgn.graphs.proximal_residues.get_interacting_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Protein ligand interacting atom extractor. Takes a ligand and protein pair and uses the built in ODDT functions
to output the interacting residue.
NOTE: The exact format needs to be decided on in order to be as general as possible. Will start with just being a
helped function and the exact form can be finalized as the MPNN frameworks become more clear.
:param ligand: oddt.toolkit.Molecule object</p>
<blockquote>
<div><p>Molecules, which are analysed in order to find interactions.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protein</strong> -- oddt.toolkit.Molecule object
Molecules, which are analysed in order to find interactions.</p></li>
<li><p><strong>distance_cutoff</strong> -- float (default=4.5)
Cutoff distance for close contacts.</p></li>
<li><p><strong>ignore_hoh</strong> -- bool (default = True) Should the water molecules be ignored. This is based on the name of the
residue ('HOH').</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>???? (Probably start with the interacting residues for testing and then move on for there (Need to figure
this out.)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torch_pgn.graphs.proximal_residues.get_molecule_graph">
<span class="sig-prename descclassname"><span class="pre">torch_pgn.graphs.proximal_residues.</span></span><span class="sig-name descname"><span class="pre">get_molecule_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecule_atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_pgn.graphs.proximal_residues.get_molecule_graph" title="Permalink to this definition"></a></dt>
<dd><p>Constructs the ligand portion of the interaction graph (intra-ligand edges and nodes) and returns them as a set of
node index values and an edge array.
:param molecule: oddt.toolkit.Molecule object</p>
<blockquote>
<div><p>Molecule, which are analysed in order to find interactions.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>molecule_atoms</strong> -- The molecule atoms involved in an interaction with the interaction partner formatted as a</p>
</dd>
</dl>
<p>numpy atom_dict (See <a class="reference external" href="https://oddt.readthedocs.io/en/0.1.1/rst/oddt.html">https://oddt.readthedocs.io/en/0.1.1/rst/oddt.html</a>)
:param depth: The depth away from interacting atoms to go in the molecular graph to construct the final
interaction graph. i.e. if molecule atom 5 is interacting and has neighbors 3, and 4 that don't interact, if the
depth is == 1 then 3 and 4 will not be included in the interaction graph if depth is == 2 then both 3 and 4 will be
added to the interaction graph. For depth &gt; 2 this process is repeated iteratively for the new atoms added to the
interaction graph. If depth == 0 no intra-molecule edges will be added. (This may be a poor initial choice, but
it seems like this may be the best approximation to PLEC)
:return: nodes, edges:</p>
<blockquote>
<div><p>nodes = a set() of nodes to be included in the interaction graph.
edges = A numpy array of edge formatted for pytorch. Format is [[s1, s2, s3...], [d1, d2, d3, ...]].
All edges will be bidirectional i.e. iff i -&gt; j exists j -&gt; i exists.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torch_pgn.graphs.proximal_residues.get_proximal_atoms">
<span class="sig-prename descclassname"><span class="pre">torch_pgn.graphs.proximal_residues.</span></span><span class="sig-name descname"><span class="pre">get_proximal_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ligand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protein</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_hoh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_pgn.graphs.proximal_residues.get_proximal_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Protein ligand interacting atom extractor. Takes a ligand and protein pair and uses the built in ODDT functions
to output the interacting residue.
NOTE: The exact format needs to be decided on in order to be as general as possible. Will start with just being a
helped function and the exact form can be finalized as the MPNN frameworks become more clear.
:param ligand: oddt.toolkit.Molecule object</p>
<blockquote>
<div><p>Molecules, which are analysed in order to find interactions.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protein</strong> -- oddt.toolkit.Molecule object
Molecules, which are analysed in order to find interactions.</p></li>
<li><p><strong>distance_cutoff</strong> -- float (default=4.5)
Cutoff distance for close contacts.</p></li>
<li><p><strong>ignore_hoh</strong> -- bool (default = True) Should the water molecules be ignored. This is based on the name of the
residue ('HOH').</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>???? (Probably start with the interacting residues for testing and then move on for there (Need to figure
this out.)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-torch_pgn.graphs.proximity_graph">
<span id="torch-pgn-graphs-proximity-graph-module"></span><h2>torch_pgn.graphs.proximity_graph module<a class="headerlink" href="#module-torch_pgn.graphs.proximity_graph" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="torch_pgn.graphs.proximity_graph.yield_full_interaction_graph">
<span class="sig-prename descclassname"><span class="pre">torch_pgn.graphs.proximity_graph.</span></span><span class="sig-name descname"><span class="pre">yield_full_interaction_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ligand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protein</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lig_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">receptor_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_hoh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visualize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_pgn.graphs.proximity_graph.yield_full_interaction_graph" title="Permalink to this definition"></a></dt>
<dd><p>Takes in the receptor and the docked ligand and produces a graph working_data.
:param ligand: oddt.toolkit.Molecule object</p>
<blockquote>
<div><p>Molecules, which are analysed in order to find interactions.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protein</strong> -- oddt.toolkit.Molecule object
Molecules, which are analysed in order to find interactions.</p></li>
<li><p><strong>distance_cutoff</strong> -- float (default=4.5)
Cutoff distance for close contacts.</p></li>
<li><p><strong>ignore_hoh</strong> -- bool (default = True) Should the water molecules be ignored. This is based on the name of the
residue ('HOH').</p></li>
<li><p><strong>visualize</strong> -- whether to visualize the final output graph using matplotlib projection into 2d space</p></li>
<li><p><strong>maintain_lig</strong> -- If True the entire ligand will be maintained regardless of atom proximity. Otherwise the ligand</p></li>
</ul>
</dd>
</dl>
<p>will be allowed to fragment based on the proximity graph.
:return: A networkx graph of featurized nodes and edges representing the interaction of the protein and ligand.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torch_pgn.graphs.proximity_graph.yield_tree_reduction">
<span class="sig-prename descclassname"><span class="pre">torch_pgn.graphs.proximity_graph.</span></span><span class="sig-name descname"><span class="pre">yield_tree_reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ligand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protein</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lig_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">receptor_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_hoh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visualize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_connect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_pgn.graphs.proximity_graph.yield_tree_reduction" title="Permalink to this definition"></a></dt>
<dd><p>Takes in the receptor and the docked ligand and produces a tree version of this working_data. Calculated using Kruskal's and
networkx.
Note: This could likely be done much more efficiently, but not sure if this will be the bottleneck so can refactor
if required.
:param ligand: oddt.toolkit.Molecule object</p>
<blockquote>
<div><p>Molecules, which are analysed in order to find interactions.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protein</strong> -- oddt.toolkit.Molecule object
Molecules, which are analysed in order to find interactions.</p></li>
<li><p><strong>distance_cutoff</strong> -- float (default=4.5)
Cutoff distance for close contacts.</p></li>
<li><p><strong>ignore_hoh</strong> -- bool (default = True) Should the water molecules be ignored. This is based on the name of the
residue ('HOH').</p></li>
<li><p><strong>visualize</strong> -- whether to visualize the final output graph using matplotlib projection into 2d space</p></li>
<li><p><strong>local_connect</strong> -- bool (default=True) Boolean flag to reestablish intra-ligand/protein connectivity after tree</p></li>
</ul>
</dd>
</dl>
<p>reduction.
:return: A networkx graph of featurized nodes and edges representing the interaction of the protein and ligand.</p>
</dd></dl>

</section>
<section id="module-torch_pgn.graphs">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-torch_pgn.graphs" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, keiserlab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>